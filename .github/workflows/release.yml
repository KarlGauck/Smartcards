name: Smartcards

on:
	push:
		tags:
			- "*"

jobs:
	build:
		runs-on: 6.15.4-arch2-1
		permissions:
			contents: write
		steps:
			- uses: actions/checkout@v3
			
			- name: Use Node.js
				uses: actions/setup-node@v3
				with:
					node-version: "18.x"

			- name:	Build plugin
				run: |
					npm install
					npm run build

			- name: create release
				env: 
					GITHUB_TOKEN: ${{ secrets.RELEASE_TOKEN }}
					run: |
						tag="${GITHUB_REF#refs/tags/}"

					gh release create "$tag" \
						--title="$tag" \
						--draft \
						main.js mainifest.json styles.css

